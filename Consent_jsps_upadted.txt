<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>

<%
    /* Token coming from email URL */
    String token = request.getParameter("token");
    if (token == null) {
        token = "";
    }
%>

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Merchant Consent</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f4f6f8;
}

.consent-container {
    width: 700px;
    margin: 60px auto;
    background: #ffffff;
    border-radius: 6px;
    box-shadow: 0px 0px 12px rgba(0,0,0,0.1);
    padding: 25px;
}

.consent-header {
    background: #003366;
    color: #fff;
    padding: 15px;
    font-size: 18px;
    font-weight: bold;
    text-align: center;
    border-radius: 4px;
}

.question-box {
    margin: 20px 0;
    padding: 15px;
    background: #eef5ff;
    border-left: 5px solid #003366;
    font-size: 16px;
    font-weight: bold;
}

.agreement-box {
    border: 1px solid #ccc;
    height: 220px;
    overflow-y: auto;
    padding: 15px;
    font-size: 13px;
    line-height: 1.6;
    background: #fafafa;
}

.checkbox-section {
    margin-top: 15px;
}

.checkbox-section input {
    margin-right: 8px;
}

.error-msg {
    color: red;
    font-size: 13px;
    display: none;
    margin-top: 8px;
}

.button-section {
    margin-top: 25px;
    text-align: center;
}

.btn {
    padding: 10px 25px;
    font-size: 14px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin: 0 10px;
}

.btn-yes {
    background: #28a745;
    color: #fff;
}

.btn-no {
    background: #dc3545;
    color: #fff;
}

.btn:disabled {
    background: #b5b5b5;
    cursor: not-allowed;
}
</style>

<script>
let isScrolled = false;

function checkScroll(ele) {
    if (ele.scrollTop + ele.clientHeight >= ele.scrollHeight) {
        isScrolled = true;
        document.getElementById("agreeChk").disabled = false;
    }
}

function submitConsent(decision) {
    const chk = document.getElementById("agreeChk");
    const err = document.getElementById("errMsg");

    if (!isScrolled) {
        err.innerHTML = "Please read the agreement fully before proceeding.";
        err.style.display = "block";
        return;
    }

    if (!chk.checked) {
        err.innerHTML = "Please confirm that you have read and agreed to the terms.";
        err.style.display = "block";
        return;
    }

    err.style.display = "none";
    document.getElementById("decision").value = decision;
    document.getElementById("consentForm").submit();
}
</script>

</head>

<body>

<div class="consent-container">

    <div class="consent-header">
        Merchant Onboarding Consent
    </div>

    <div class="question-box">
        Would you like to register for our Bank Acquiring Services?
    </div>

    <div class="agreement-box" onscroll="checkScroll(this)">
        <b>Standard Merchant Agreement</b><br><br>

        This agreement is made between the Merchant and the Bank for availing
        acquiring services. By accepting this agreement, the Merchant agrees
        to comply with all rules, regulations, and operational guidelines
        prescribed by the Bank.<br><br>

        The Merchant confirms that all information provided is true and valid.
        The Bank reserves the right to verify, approve, or reject the request
        based on internal policies.<br><br>

        The services include transaction processing, settlement, reporting,
        and related merchant acquiring facilities.<br><br>

        The Merchant understands that clicking “Yes” shall be considered
        as a digital signature and legally binding acceptance of this agreement.<br><br>

        Any misuse, fraudulent activity, or violation may lead to termination
        of services without prior notice.<br><br>

        (Scroll till end to enable acceptance...)
    </div>

    <form id="consentForm" method="post"
          action="<%=request.getContextPath()%>/consentApprovalAction.do">

        <input type="hidden" name="token" value="<%=token%>">
        <input type="hidden" name="decision" id="decision">

        <div class="checkbox-section">
            <input type="checkbox" id="agreeChk" disabled />
            I have read and understood the agreement fully
        </div>

        <div id="errMsg" class="error-msg"></div>

        <div class="button-section">
            <button type="button" class="btn btn-yes"
                    onclick="submitConsent('APPROVED')" disabled id="yesBtn">
                Yes
            </button>

            <button type="button" class="btn btn-no"
                    onclick="submitConsent('REJECTED')" disabled id="noBtn">
                No
            </button>
        </div>

    </form>

</div>

<script>
document.getElementById("agreeChk").addEventListener("change", function () {
    document.getElementById("yesBtn").disabled = !this.checked;
    document.getElementById("noBtn").disabled = !this.checked;
});
</script>

</body>
</html>
----------------------------------------------------------------------------------------------------------
<%@ page contentType="text/html; charset=UTF-8"%>
<html>
<head>
<title>Consent Submitted</title>

<style>
.response-container {
    max-width: 720px;
    margin: 90px auto;
    background: #ffffff;
    border-radius: 8px;
    box-shadow: 0 0 12px rgba(0,0,0,0.15);
    padding: 45px 20px;
    text-align: center;
}

.tick {
    font-size: 72px;
    color: #28a745;
    margin-bottom: 20px;
}

.title {
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 10px;
}

.subtext {
    font-size: 14px;
    color: #555;
}

/* Mobile */
@media (max-width: 768px) {
    .response-container {
        width: 95%;
        margin-top: 60px;
    }
}
</style>

</head>

<body class="inner">

<div class="wrapper">

<header>
    <div class="row-one">
        <div class="container">
            <img src="${pageContext.request.contextPath}/images/DIB/merchant-logo-big.png"
                 class="brandLogo">
        </div>
    </div>
</header>

<section class="section-bg">
<div class="container">

    <div class="response-container">
        <div class="tick">✔</div>

        <div class="title">
            Thank you for your response
        </div>

        <div class="subtext">
            Your consent response has been recorded successfully.<br/>
            You may now close this tab.
        </div>
    </div>

</div>
</section>

<%@ include file="/layout/GenCredits_bootstrap4_updated.jsp"%>

</div>
</body>
</html>
----------------------------------------------------------------------------------------------------

<%@ page contentType="text/html; charset=UTF-8"%>
<html>
<head>
<title>Consent Submitted</title>

<style>
.box {
    width: 400px;
    margin: 120px auto;
    background: #fff;
    padding: 40px;
    text-align: center;
    border-radius: 6px;
    box-shadow: 0 0 10px rgba(0,0,0,0.15);
}

.tick {
    width: 70px;
    height: 70px;
    margin: 0 auto 20px;
    border-radius: 50%;
    background: #28a745;
    color: #fff;
    font-size: 40px;
    line-height: 70px;
    animation: pop 0.4s ease;
}

@keyframes pop {
    0% { transform: scale(0); }
    80% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

.msg {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 8px;
}

.sub {
    font-size: 13px;
    color: #555;
}

@media(max-width:600px){
    .box { width: 90%; }
}
</style>
</head>

<body class="inner">

<div class="wrapper">

<header>
    <div class="row-one">
        <div class="container">
            <img src="${pageContext.request.contextPath}/images/DIB/merchant-logo-big.png"
                 class="brandLogo">
        </div>
    </div>
</header>

<section class="section-bg">
<div class="container">

    <div class="box">
        <div class="tick">✓</div>
        <div class="msg">Thank you for your response</div>
        <div class="sub">
            Your consent has been recorded.<br/>
            You may close this tab.
        </div>
    </div>

</div>
</section>

<%@ include file="/layout/GenCredits_bootstrap4_updated.jsp"%>

</div>
</body>
</html>
