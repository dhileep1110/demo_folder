MerchantOnboardSevice.class:

	private EmailServiceDAO emailServiceDao;
public EmailServiceDAO getEmailServiceDAO() {
		return emailServiceDao;
	}
	public void setEmailServiceDAO(EmailServiceDAO emailServiceDao) {
		this.emailServiceDao = emailServiceDao;
	}


  if(ibData.equalsIgnoreCase("IB") && recStusToInsert == 0) {
			            	String token = UUID.randomUUID().toString().replace("-", "");
			            	//insert consent record
			            	emailServiceDao.insertConsentRecord(bulkAppNmbr,custEmail,mercCode,mercName, token,sessionBean.getUserId());
			            	//Send Consent Mail
			            	sendConsentMail(custEmail,mercCode,mercName,token,sessionBean);
			            }

Complete method:

try {
				mercCode = merchantBodyList.get(2).trim() != null || !merchantBodyList.get(2).trim().isEmpty() ? merchantBodyList.get(2).trim() : "";
				mercName = merchantBodyList.get(4).trim() != null || !merchantBodyList.get(4).trim().isEmpty() ? merchantBodyList.get(4).trim() : "";
				custEmail = merchantBodyList.get(17).trim() != null || !merchantBodyList.get(17).trim().isEmpty() ? merchantBodyList.get(17).trim() : "";
			    custPan = merchantBodyList.get(18).trim() != null || !merchantBodyList.get(18).trim().isEmpty() ? merchantBodyList.get(18).trim() : "";
			    ibData = merchantBodyList.get(52).trim() != null || !merchantBodyList.get(52).trim().isEmpty() ? merchantBodyList.get(52).trim() : "";
			    if (!mercCode.isEmpty() && !custEmail.isEmpty() && !custPan.isEmpty()) {
			        dupCount = merchantOnboardDAO.getDuplicateCount(mercCode, custEmail, custPan);
			        hasRowErrors = (rowErrors != null && !rowErrors.isEmpty());

			        if (dupCount == 0) {
			        	recStusToInsert = hasRowErrors ? recStus : 0; // if not duplicate recstus = 3 (for Error) if no errors then recstus = 0
			            errorDesc = hasRowErrors ? rowErrors.toString().substring(1, rowErrors.toString().length() - 1) : fieldErrorDescBulk;

			            if (hasRowErrors) { merchantErrorList.add(rowErrors.toString()); }
			            
			            if(ibData.equalsIgnoreCase("IB") && recStusToInsert == 0) {
			            	String token = UUID.randomUUID().toString().replace("-", "");
			            	//insert consent record
			            	emailServiceDao.insertConsentRecord(bulkAppNmbr,custEmail,mercCode,mercName, token,sessionBean.getUserId());
			            	//Send Consent Mail
			            	sendConsentMail(custEmail,mercCode,mercName,token,sessionBean);
			            }

			            output = merchantOnboardDAO.insertTempTable(merchantBean, merchantBodyList, merchantBodyList.size(), srcFilePathwithname, filename, 
			            		userId, instCode, recStusToInsert, recordNum, errorDesc, bulkLogRefId, bulkAppNmbr);
			        } else {
			        	recStusToInsert = 6;
				        String duplicateMsg = "Duplicate record is present for Application No. " + bulkAppNmbr;
				        if (hasRowErrors) {
				            errorDesc = duplicateMsg + " | " + rowErrors.toString().substring(1, rowErrors.toString().length() - 1);
				            merchantErrorList.add(rowErrors.toString());
				        } else {
				            errorDesc = duplicateMsg;
				        }
						output = merchantOnboardDAO.insertTempTable(merchantBean, merchantBodyList, merchantBodyList.size(), srcFilePathwithname, filename, 
								userId, instCode, recStusToInsert, recordNum, errorDesc, bulkLogRefId, bulkAppNmbr);
			        }
			    } else {
			    	recStusToInsert = 3;
			    	hasRowErrors = (rowErrors != null && !rowErrors.isEmpty());
			    	errorDesc = hasRowErrors ? rowErrors.toString().substring(1, rowErrors.toString().length() - 1) : fieldErrorDescBulk;
			    	output = merchantOnboardDAO.insertTempTable(merchantBean, merchantBodyList, merchantBodyList.size(), srcFilePathwithname, filename, 
		            		userId, instCode, recStusToInsert, recordNum, errorDesc , bulkLogRefId, bulkAppNmbr);
			    }
			} catch (Exception e) {
			    loggerUtil.error("Error during duplicate record check: ", e);
			}
			
			merchantBodyList.clear();
			rowErrors.clear();
		} catch (Exception e) {
			merchantOnboardDAO.updateBulkUpldLogDetails(bulkLogRefId, "Failure - "+e.getMessage(), 2);
			loggerUtil.error("Error while inserting into temp table : ", e);
		}
		finally {
			fieldErrorDescBulk = null; rowErrors = null; bulkLogRefId = null; isMandatoryFlag = null; validationType = null; fieldDesc = null; 
			condValidType = null; possibleValues = null; tokenval = null; mercCode = null; custEmail = null; custPan = null; errorDesc = null;
		}
		return output;
	}
